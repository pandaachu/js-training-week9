{"version":3,"sources":["all.js"],"names":["baseUrl","api_path","productList","cartList","productWrap","document","querySelector","cartListWrap","totalPrice","deleteAllCartItemBtn","submitOrderBtn","productId","init","getProductList","getCartList","axios","get","then","res","data","products","console","log","productListRender","getProductId","str","forEach","item","images","id","title","dollarSign","origin_price","price","innerHTML","carts","textContent","finalTotal","cartListRender","deleteCartItem","product","quantity","addCardBtns","querySelectorAll","addEventListener","e","preventDefault","target","getAttribute","addToCart","cartData","post","btnDelete","cartId","alert","response","error","name","tel","email","address","payment","length","value","clearFormData","money"],"mappings":"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","file":"all.js","sourcesContent":["const baseUrl = \"https://hexschoollivejs.herokuapp.com\";\nconst api_path = \"pandaa\";\n// const token = \"0wqEojiDq0e1LPUqwrhkeg0wcX43\";\nlet productList = [];\nlet cartList = [];\nconst productWrap = document.querySelector('.productWrap');\nconst cartListWrap = document.querySelector('.js-cartList');\nconst totalPrice = document.querySelector('.js-totalPrice');\nconst deleteAllCartItemBtn = document.querySelector('.discardAllBtn');\nconst submitOrderBtn = document.querySelector('.orderInfo-btn');\nlet productId = '';\n\nfunction init() {\n  getProductList();\n  getCartList();\n}\n\ninit();\n\n// 取得產品清單\nfunction getProductList() {\n  axios.get(`${baseUrl}/api/livejs/v1/customer/${api_path}/products`)\n    .then(function(res) {\n      productList = res.data.products;\n      console.log('產品清單',productList);\n      productListRender();\n      getProductId();\n    })\n}\n\n// 產品清單 render\nfunction productListRender() {\n  let str = '';\n  productList.forEach(function(item) {\n    str += `<li class=\"productCard\">\n    <h4 class=\"productType\">新品</h4>\n    <img\n      src=\"${ item.images }\"\n      alt=\"\"\n    />\n    <a href=\"#\" id=\"addCardBtn\" data-id=\"${item.id}\">加入購物車</a>\n    <h3>${ item.title }</h3>\n    <del class=\"originPrice\">${ dollarSign(item.origin_price) }</del>\n    <p class=\"nowPrice\">${ dollarSign(item.price) }</p>\n  </li>`\n  })\n  productWrap.innerHTML = str;\n}\n\n// 取得購物車清單\nfunction getCartList() {\n  axios.get(`${baseUrl}/api/livejs/v1/customer/${api_path}/carts`)\n  .then(function(res) {\n    cartList = res.data.carts;\n    console.log('購物車清單',cartList);\n    totalPrice.textContent = dollarSign(res.data.finalTotal);\n    cartListRender();\n    deleteCartItem();\n  })\n  .catch(function() {\n    console.log('讀取失敗，請稍後再試');\n  })\n}\n\n// 購物車清單 render\nfunction cartListRender() {\n  let str = '';\n  cartList.forEach(function(item) {\n    str += `\n    <tr>\n      <td>\n        <div class=\"cardItem-title\">\n          <img src=\"${ item.product.images }\" alt=\"\" />\n          <p>${ item.product.title }</p>\n        </div>\n      </td>\n      <td>${ dollarSign(item.product.price) }</td>\n      <td>${ item.quantity }</td>\n      <td>${ dollarSign(item.product.price * item.quantity)}</td>\n      <td class=\"discardBtn\">\n        <a href=\"#\" class=\"material-icons js-btnDelete\" data-id=\"${item.id}\"> clear </a>\n      </td>\n    </tr>`\n  })\n  cartListWrap.innerHTML = str;\n\n}\n\nfunction getProductId() {\n  const addCardBtns = document.querySelectorAll('#addCardBtn');\n  addCardBtns.forEach(function(item) {\n    item.addEventListener('click', function(e){\n      e.preventDefault();\n      productId = e.target.getAttribute(\"data-id\");\n      addToCart();\n    })\n  })\n}\n\n// 加入購物車\nfunction addToCart() {\n  let cartData = {\n    \"data\": {\n      \"productId\": productId,\n      \"quantity\": 1\n    }\n  };\n  axios.post(`${baseUrl}/api/livejs/v1/customer/${api_path}/carts`, cartData)\n    .then(function(res) {\n      console.log(res,'加入購物車');\n      getCartList();\n    })\n}\n\n// 刪除單筆購物車訂單\nfunction deleteCartItem() {\n  const btnDelete = document.querySelectorAll('.js-btnDelete');\n  let cartId = '';\n  btnDelete.forEach(function(item) {\n    item.addEventListener('click', function(e){\n      e.preventDefault();\n      cartId = e.target.getAttribute(\"data-id\");\n      axios.delete( `${baseUrl}/api/livejs/v1/customer/${api_path}/carts/${cartId}`)\n        .then(function(res) {\n          alert('刪除成功。');\n          getCartList();\n        })\n    })\n  })\n}\n\n// 刪除全部\ndeleteAllCartItemBtn.addEventListener('click',function(e){\n  e.preventDefault();\n  axios.delete(`${baseUrl}/api/livejs/v1/customer/${api_path}/carts`)\n  .then(function (response) {\n    alert('刪除全部購物車成功。');\n    cartList = response.data.carts;\n    getCartList();\n  }).catch(function(error){\n    alert(error);\n  });\n})\n\nsubmitOrderBtn.addEventListener('click', function(e){\n  e.preventDefault();\n  const name = document.querySelector('#customerName');\n  const tel = document.querySelector('#customerPhone');\n  const email = document.querySelector('#customerEmail');\n  const address = document.querySelector('#customerAddress');\n  const payment = document.querySelector('#tradeWay');\n\n  if(cartList.length == 0)\n  {\n    alert('請選擇商品');\n    return;    \n  }\n  \n\n  axios.post(`${baseUrl}/api/livejs/v1/customer/${api_path}/orders`, \n  {\n    \"data\": {\n      \"user\": {\n        \"name\": name.value,\n        \"tel\": tel.value,\n        \"email\": email.value,\n        \"address\": address.value,\n        \"payment\": payment.value\n      }\n    }\n  })\n  \n  .then(function (response) {\n    alert(`訂單送出成功。`);\n    getCartList();\n    clearFormData();\n  }).catch(function(error){\n    alert(error);\n  });\n})\n\nfunction clearFormData(){\n  name.value = '';\n  tel.value = '';\n  email.value = '';\n  address.value = '';\n  payment.value = \"ATM\";\n}\n\n// add dollar sign\nfunction dollarSign(money) {\n  return `NT$${ money }`\n}\n"]}